{% if partial %}{% extends "includes/partial.html" %}{% endif %}
<table class="table table-striped table-narrow m_view m_view-groupmembers">
<thead>
  <tr>
    <th>Username</th>
    <th>Real name</th>
    <th>Role</th>
  </tr>
</thead>
<tbody>
{%- block partial -%}
{%- for gm in members -%}
  <tr class="user-tablerow m_instance">
    <td class="m_field" name="username" data-value="{{gm.member.username}}">
      <a href="{{ url_for('social.user_detail', username=gm.member.username) }}">
      <img class="avatar" src="{{ gm.member.gravatar_url() }}" />
      <strong class="message_name">{{gm.member.username}}</strong>
    </a></td>
    <td>{{gm.member.realname}}</td>
    <td>{{gm.status_text()}}</td>
    {% if form %}<td>
      {% if form and gm.status != 1 %}
        <button type="button" class="btn btn-small m_action" data-action-type="modal" href="{{ url_for('social.group_members_change', groupslug=group.slug, action='remove', players=gm.member.username, view='m_group_member_view') }}">
          <i class="icon-remove"></i>
        </button>
        {% if gm.status==2 %}<button type="button" class="btn btn-mini m_action" data-action-type="modal" href="{{ url_for('social.group_members_change', groupslug=group.slug, action='add', masters=gm.member.username, view='m_group_member_view') }}">
          Make master?
        </button>{% endif %}
      {% endif %}
    </td>{% endif %}
  </tr>
{%- endfor -%}
{%- endblock -%}

</tbody>
{% if form -%}
<tfoot><tr><td colspan="4">
  <label>Add players</label>
  <ul class="typeahead-list typeahead-user">
    <li class="typeahead-input"><input class="typeahead-user-input" type="text" data-provide="typeahead" data-exclude-view=".m_view-groupmembers" /></li>
  </ul><button type="button" class="btn btn-primary m_action" href="{{ url_for('social.group_members_change', groupslug=group.slug, action='add', view='m_group_member_view') }}">Add</button>
</td></tr></tfoot>
<script>
  jQuery.getJSON('/api/username/', function(data) { $('.typeahead-user input').typeahead({source: data.objects}) })
</script>
{% endif %}
</table>
