{% if pagination and pagination.pages > 1 %}
  {% set urlargs = url_for_args.pop('page', none) %} {# need to remove page if there already #}
  {% set urlargs = url_for_args %}
  <div>
    <ul class="pagination">
      {%- for page in pagination.iter_pages(right_current=3) %}
        {% if page %}
          {% if page != pagination.page %}
            <li><a href="{{ url_for(request.endpoint, page=page, **urlargs) }}">{{ page }}</a></li>
          {% else %}
            <li class="active"><a href="{{url_for(request.endpoint, page=page, **urlargs)}}">{{ page }}</a></li>
          {% endif %}
        {% else %}
          <li><span>...</span></li>
        {% endif %}
      {%- endfor %}
    </ul>
  </div>
{% endif %}