{% extends "world/world_item.html" if not parent_template else parent_template %}

{% if request.args.get('groupby')=='type' %}
    {% set groups = articles|by_articletype %}
    {% set type_tab = ' class=active' %}
{% elif request.args.get('groupby')=='time' %}
    {% set groups = articles|by_time %}
    {% set time_tab = ' class=active' %}
{% else %} {# request.args.get('groupby')=='title' #}
    {% set groups = articles|by_initials %}
    {% set title_tab = ' class=active' %}
{% endif %}

{% block pre_content %}
<h2>{{ _('Browse') }}</h2>
<ul class="nav nav-tabs content-menu">
    <li{{title_tab}}><a href="{{ url_for('.article_list', world=world.slug, groupby='title') }}"><span class="glyphicon glyphicon-book"></span> {{ _('By title') }}</a></li>
    <li{{type_tab}}><a href="{{ url_for('.article_list', world=world.slug, groupby='type') }}"><span class="glyphicon glyphicon-tag"></span> {{ _('By type') }}</a></li>
    <li{{time_tab}}><a href="{{ url_for('.article_list', world=world.slug, groupby='time') }}"><span class="glyphicon glyphicon-calendar"></span> {{ _('By time') }}</a></li>
    <li><a href="{{ url_for('.article_list', world=world.slug, groupby='relation') }}"><span class="glyphicon glyphicon-resize-small"></span> {{ _('By relation') }}</a></li>
</ul>
{% endblock %}

{% block content %}
    <div class="panel panel-default">
    {% if articles.count() == 0 %}No articles yet!{% else %}
    <dl>
        {% for group in groups %}
        <dt>{{ group.grouper|capitalize }}</dt>
        <dd><ul class="list-unstyled">
        {% for article in group.list %}
            <li><a href="{{ url_for('.article_view', article=article.slug, world=world.slug) }}">{{article.title}}</a>
                {%- if groupby=='title' -%}
                    <small>{{" ["+article.type_name()+"]"}}</small>
                {%- elif groupby=='time' -%}
                    <small>{{" ["+article.created_date.strftime('%Y-%m-%d %H:%M')+"]"}}</small>
                {%- endif %}</li>
            {% endfor %}
        </ul></dd>
        {% endfor %}
    </dl>
    </div>
    {% endif %}
{% endblock %}
